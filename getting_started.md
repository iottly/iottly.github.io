# Getting Started Project

The Getting Started project demonstrates a simple use case where a Raspbberry Pi is connected to temperature and humidity sensors, regularly acquiring values from an industrial machine.

> To let you try the project without the need of a physical Pi, we created an Elastic Pi in the project. 
> Elastic Pis are virtual devices hosted on our infrastructure, always connected and programmable from iottly.
> Just as a real Pi the ElasticPi communicates with iottly using MQTT protocol without exposing any port to the Internet.
> Use the ElasticPi to tinker with iottly and try your new ideas before shipping them to a real Pi.
> Just keep in mind that there is no GPIO support â€¦ for now ;-)

In the demo project the values of the sensors are randomly generated by an ad hoc function defined in the `global` section:
```
def read_data_from_sensor(sensortype):
  #randomly generate read_value based on sensortype
  if sensortype == "temperature":
    # randomly generate temperature value
    return read_value
  elif sensortype == "humidity":
    # randomly generate humidity value
    return read_value
```
The main code in the `loop` section, simply polls sensors' data value every 5 sec, as it would do in a real scenario, and stores it in a global variable (as usual defined in the global section):
```
def loop():
  temp_value.value = read_data_from_sensor("temperature")
  hum_value.value = read_data_from_sensor("humidity")
  time.sleep(10)
```
Now, let's say we want to remotely ask the Pi for the temperature and/or humidity value. What we need is a command and the code in the command handler.
The command is defined through the Messages panel in Iottly, with the following structure:
```
{"ask_sensor_data": {"sensortype": "<temperature|humidity|both>"}}
```
Where:
- `ask_sensor_data` is the **message type** describing that we will use this command to ask sensor data to the py
- `sensortype` is a **keyword** accepting 3 possible values, to allow us to ask for temperature, humidity or both.

Iottly automatically generate the command handler for us, all we need to do is to put some code inside, to get the requested data from the global variables and sending it to Iottly through MQTT:
```
def ask_sensor_data(command):
  # based on value of sensortype get the data :
  #   - from temp_value.value, 
  #   - or from hum_value.value
  #   - or from both of them

  # prepare a message as the following:
  # {"sensor_data_reading":{
  #    "temperature": <temp value from temp_value.value>,
  #    "humidity": <h value from temp_value.value>,
  #  }}
  # the two keys will be both present or not, 
  # depending on what the command is asking for

  # finally send the message over MQTT with the built in iottly function
```
#### Try this exercise:


After building the temperature and humidity control program, we send an alarm message when the temperature exceeds the safety limit

###### In the loop section:
```
  if (temp_value.value > 48): # create a contorl cicle
    alarm = dict(description="temperature too high" , temp_value = temp_value.value) # create a dictionary  
    message = dict(ALARM = alarm) # create a new dictionary for print alarm in the landing
    send_msg(message) # send message in the consol pannel 
    
```
